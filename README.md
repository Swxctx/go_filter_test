#### 主要用于文字的过滤判断性能及准确率测试
- bloom过滤器
- cuckoo过滤器
- strings包查找
- regexp查找
- sego中文分词
- 自动分2、3、4词

##### 分词
这里并没有采用分词库操作，使用了简单的分词代码实现2、3、4的全部分词，主要测试查找的准确率一会性能。

##### 耗时测试
- 过滤词

```
广告,电脑,不会,大家,我们,在一起,最高级,最大,最小,全世界,全国,全部的,最小的,最好的,免费的,包好,全部免费,平台
```
- 需过滤标题

```
网易新闻 - 头条视频资讯阅读平台
```
- 标题采用正则提取汉字

```
网易新闻头条视频资讯阅读平台
```
- 标题进行简单分词(没有去除基本词汇)

```
[网易 易新 新闻 闻头 头条 条视 视频 频资 资讯 讯阅 阅读 读平 平台 网易新 易新闻 新闻头 闻头条 头条视 条视频 视频资 频资讯 资讯阅 讯阅读 阅读平 读平台 网易新 易新闻 新闻头 闻头条 头条视 条视频 视频资 频资讯 资讯阅 讯阅读 阅读平]
```
- 运行结果如下

```
2017/11/13 10:06:39 bloom
2017/11/13 10:06:39 bloom标题不合法-非法词: 平台
2017/11/13 10:06:39 耗时(ns): 174945
2017/11/13 10:06:39 flag: true
2017/11/13 10:06:39
2017/11/13 10:06:39 cuckoo
2017/11/13 10:06:39 cuckoo标题不合法-非法词: 平台
2017/11/13 10:06:39 耗时(ns): 78832
2017/11/13 10:06:39 flag: true
2017/11/13 10:06:39
2017/11/13 10:06:39 use_strings
2017/11/13 10:06:39 contains
2017/11/13 10:06:39 标题不合法-非法词: 平台
2017/11/13 10:06:39 耗时(ns): 42966
2017/11/13 10:06:39 flag: true
2017/11/13 10:06:39
2017/11/13 10:06:39 containsAny
2017/11/13 10:06:39 标题不合法-非法词: 读平
2017/11/13 10:06:39 耗时(ns): 62104
2017/11/13 10:06:39 flag: true
2017/11/13 10:06:39
2017/11/13 10:06:39 indexAny
2017/11/13 10:06:39 标题不合法-非法词: 读平
2017/11/13 10:06:39 耗时(ns): 73124
2017/11/13 10:06:39 flag: true
2017/11/13 10:06:39
```
- 分析  
结果显示’平台‘为非法词语，ContainsAny与IndexAny显示非法词为‘读平’则是取决于本身的特性，他们是通过位置来进行搜索的。
通过结果可以看出耗时排行为：

```
bloom: 174945
cuckoo: 78832
Contains: 42966
ContainsAny: 62104
IndexAny: 73124
```
通过耗时可以看出Contains查找所用的时间最短，当然这只是针对较短的过滤词以及较短的标题而言，对于大量的数据还是稍逊于Bloom于Cuckoo过滤器；而ContainsAny于IndexAny耗时高于Contains则是因为其特性决定的，它们查找的是位置，自然就会产生相关遍历，耗时也就有所增加了。

##### 准确性测试
- 过滤词

```
广告,电脑,不会,大家,我们,在一起,最高级,最大,最小,全世界,全国,全部的,最小的,最好的,免费的,包好,全部免费,微爱
```
- 过滤标题

```
网易新闻 - 头条视频资讯阅读平台
```
- 标题采用正则提取汉字

```
网易新闻头条视频资讯阅读平台
```
- 标题进行简单分词(没有去除基本词汇)

```
[网易 易新 新闻 闻头 头条 条视 视频 频资 资讯 讯阅 阅读 读平 平台 网易新 易新闻 新闻头 闻头条 头条视 条视频 视频资 频资讯 资讯阅 讯阅读 阅读平 读平台 网易新 易新闻 新闻头 闻头条 头条视 条视频 视频资 频资讯 资讯阅 讯阅读 阅读平]
```
- 运行结果如下

```
2017/11/13 10:16:07 bloom
2017/11/13 10:16:07 flag: false
2017/11/13 10:16:07
2017/11/13 10:16:07 cuckoo
2017/11/13 10:16:07 cuckoo标题不合法-非法词: 网易新
2017/11/13 10:16:07 耗时(ns): 82810
2017/11/13 10:16:07 flag: true
2017/11/13 10:16:07
2017/11/13 10:16:07 use_strings
2017/11/13 10:16:07 contains
2017/11/13 10:16:07 flag: false
2017/11/13 10:16:07
2017/11/13 10:16:07 containsAny
2017/11/13 10:16:07 flag: false
2017/11/13 10:16:07
2017/11/13 10:16:07 indexAny
2017/11/13 10:16:07 flag: false
2017/11/13 10:16:07
```
- 分析  
结果显示在cuckoo过滤时出现了true，即过滤到了词汇，显示‘网易新’被过滤到，那么说明Cuckoo还是具有一定的误判性能。

更换标题再进行测试：  

```
2017/11/13 10:22:05 bloom
2017/11/13 10:22:05 flag: false
2017/11/13 10:22:05
2017/11/13 10:22:05 cuckoo
2017/11/13 10:22:05 cuckoo标题不合法-非法词: 龙一
2017/11/13 10:22:05 耗时(ns): 64526
2017/11/13 10:22:05 flag: true
2017/11/13 10:22:05
2017/11/13 10:22:05 use_strings
2017/11/13 10:22:05 contains
2017/11/13 10:22:05 flag: false
2017/11/13 10:22:05
2017/11/13 10:22:05 containsAny
2017/11/13 10:22:05 标题不合法-非法词: 龙一
2017/11/13 10:22:05 耗时(ns): 28520
2017/11/13 10:22:05 flag: true
2017/11/13 10:22:05
2017/11/13 10:22:05 indexAny
2017/11/13 10:22:05 标题不合法-非法词: 龙一
2017/11/13 10:22:05 耗时(ns): 75359
2017/11/13 10:22:05 flag: true
2017/11/13 10:22:05
```
通过结果可以发现，’龙一‘这个词被Cuckoo、ContainsAny、IndexAny都过滤到了，通过这里再一次的发现了Cuckoo的误判，对于ContainsAny以及IndexAny，是准确的，这两个方法是全局查找是否存在多个字符，所以在查找到'龙'与’一‘的时候就会返回true以及index。

- Bloom与Contains的对比测试
标题： 
 
```
金利来袜子男士纯棉夏季商务男袜中筒袜黑短
```
过滤词:  

```
微爱
```
测试结果：  

```
2017/11/13 10:43:56 bloom
2017/11/13 10:43:56 bloom标题不合法-非法词: 利来袜
2017/11/13 10:43:56 耗时(ns): 147006
2017/11/13 10:43:56 flag: true
2017/11/13 10:43:56
2017/11/13 10:43:56 use_strings
2017/11/13 10:43:56 contains
2017/11/13 10:43:56 flag: false
2017/11/13 10:43:56
```
通过测试可看出Bloom过滤器出现了误差，Contains过滤正常。 


##### 总结
通过测试发现，Contains的准确率是较高的，对于一般的过滤查找是可以胜任的，准确率也能得到保证，但是对于较大的容量，性能可能就会稍显不足；但是需要注意的一点是Contains匹配查找，过滤词如果是'免费的'，这时候标题如果是’免费‘，那么同样会被过滤到，因为包含了’免费‘两字，这就需要视需求而定了，当然想要解决这个问题就需要通过遍历数组来做。

- 通过遍历数组过滤
- 过滤词

```
广告,电脑,不会,大家,我们,在一起,最高级,最大,最小,全世界,全国,全部的,最小的,最好的,免费的,包好,全部免费,微爱,
```
- 标题

```
网易新闻 - 头条视频资讯阅读平台免费的
```
- 测试结果

```
2017/11/13 11:57:08 bloom
2017/11/13 11:57:08 bloom标题不合法-非法词: 免费的
2017/11/13 11:57:08 耗时(ns): 245784
2017/11/13 11:57:08 flag: true
2017/11/13 11:57:08
2017/11/13 11:57:08 cuckoo
2017/11/13 11:57:08 cuckoo标题不合法-非法词: 网易新
2017/11/13 11:57:08 耗时(ns): 80690
2017/11/13 11:57:08 flag: true
2017/11/13 11:57:08
2017/11/13 11:57:08 use_strings
2017/11/13 11:57:08 contains
2017/11/13 11:57:08 标题不合法-非法词: 免费
2017/11/13 11:57:08 耗时(ns): 42698
2017/11/13 11:57:08 flag: true
2017/11/13 11:57:08
2017/11/13 11:57:08 containsAny
2017/11/13 11:57:08 标题不合法-非法词: 台免
2017/11/13 11:57:08 耗时(ns): 77331
2017/11/13 11:57:08 flag: true
2017/11/13 11:57:08
2017/11/13 11:57:08 indexAny
2017/11/13 11:57:08 标题不合法-非法词: 台免
2017/11/13 11:57:08 耗时(ns): 77386
2017/11/13 11:57:08 flag: true
2017/11/13 11:57:08
2017/11/13 11:57:08 rune range
2017/11/13 11:57:08 标题不合法-非法词: 免费的
2017/11/13 11:57:08 耗时(ns): 63348
2017/11/13 11:57:08 flag: true
```
通过测试发现，通过遍历过滤词数组与标题数组能够准确的进行过滤，并且耗时也最低，对于过滤词以及标题较短的情况，是最合适的办法了；但是面对较大的词组时，进行遍历将会产生很大的消耗。

几种方法总结如下：  
- Bloom  
使用Bloom误判率较高，同时不支持删除添加进去的元素，容易出现位覆盖，从而导致判断出错。  
- Cuckoo  
Cuckoo支持元素删除，但是经过测试还是会出现一定的误判，适合用于大量过滤的情况使用。  
- Contains  
使用strings.Contains()方法进行过滤，对于较短词组的情况是适合的，但是由于其本身特定，不能准确的进行过滤， 过滤度较高。  
- 数组遍历  
使用过滤词遍历以及标题遍历，能够准确的进行过滤，对于较短词组，经过测试耗时也最低，但是对于大批量词组时显然是不合适的。  

##### 方案优化
通过对几种方案的测试，发现均有所缺陷，在性能或者准确性方面都有所欠缺，接下来采用Bloom过滤器以及Contains两者进行判断同步进行。  
- 测试结果

```
2017/11/13 13:46:44 bloom
2017/11/13 13:46:44 bloom标题不合法-非法词: 利来袜
2017/11/13 13:46:44 耗时(ns): 151866
2017/11/13 13:46:44 flag: true
2017/11/13 13:46:44
2017/11/13 13:46:44 contains
2017/11/13 13:46:44 flag: false
2017/11/13 13:46:44
2017/11/13 13:46:44 Bloom And Contains
2017/11/13 13:46:44 flag: false
```
- 分析
测试可见通过Bloom与Contains两者进行判断，保证了准确率，那么性能如何呢？接下来进行性能测试。如下：  

```
2017/11/13 13:48:40 bloom
2017/11/13 13:48:40 bloom标题不合法-非法词: 免费的
2017/11/13 13:48:40 耗时(ns): 188256
2017/11/13 13:48:40 flag: true
2017/11/13 13:48:40
2017/11/13 13:48:40 contains
2017/11/13 13:48:40 标题不合法-非法词: 免费
2017/11/13 13:48:40 耗时(ns): 51428
2017/11/13 13:48:40 flag: true
2017/11/13 13:48:40
2017/11/13 13:48:40 Bloom And Contains
2017/11/13 13:48:40 bloom标题不合法-非法词: 免费的
2017/11/13 13:48:40 耗时(ns): 84919
2017/11/13 13:48:40 flag: true
```
从测试结果可以看出，Bloom跟Contains两者共同计算，性能虽然高于Contains，但是却是低于Bloom的；由此可以得出结论，采用Bloom与Contains两者共同进行过滤，其准确率可以得到保证，同时性能也不会消耗太大（针对于小批量词组）。